# apiVersion: apps/v1
# kind: Deployment
# metadata:
#   name: api-gateway-deployment
# spec:
#   replicas: 1
#   selector:
#     matchLabels:
#       app: api-gateway
#   template:
#     metadata:
#       labels:
#         app: api-gateway
#     spec:
#       initContainers:
#       - name: wait-for-config-server
#         image: busybox
#         command: ['sh', '-c', 'until nslookup config-server-service; do echo waiting for config-server; sleep 2; done']
#       - name: wait-for-discovery-server
#         image: busybox
#         command: ['sh', '-c', 'until nslookup discovery-server-service; do echo waiting for discovery-server; sleep 2; done']
#       containers:
#       - name: api-gateway
#         image: {{ .Values.images.apiGateway.repository }}:{{ .Values.images.apiGateway.tag }}
#         ports:
#         - name: http
#           containerPort: {{ .Values.services.apiGateway.port }}
#           protocol: TCP
# --- 
# apiVersion: v1
# kind: Service
# metadata:
#   name: api-gateway-service
# spec:
#   type: {{ .Values.services.apiGateway.type }}
#   selector:
#     app: api-gateway
#   ports:
#     - port:  {{ .Values.services.apiGateway.port }}
#       targetPort: {{ .Values.services.apiGateway.port }}
